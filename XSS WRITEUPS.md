### ุฃูู Bug Bounty ููู โ Local File Inclusion + Stored XSS ุนูู Online IDE ๐ฏ

---

### ๐ฏ ุงููุฏู

- ุงุณุชูุฏุงู ููุตุฉ Online IDE (ุฒู VSCode) ุถูู ูุทุงู Private ูู HackerOne.
    

---

### ๐ง ููุน ุงูุซุบุฑุฉ

- **Local File Inclusion (LFI)**
    
- **Stored Cross-site Scripting (Stored XSS)**
    

---

### โ๏ธ ุฎุทูุงุช ุงูุจุญุซ ูุงูุงุณุชูุดุงู

1. **ูุชุญ ูู ุงููุทุงูุงุช ูู ุชุจููุจุงุช ูุฑูู.**
    
2. ุงููุฏู ูุงู Online IDE ููุชูุญ (ุจุฏูู ุชุณุฌูู ุฏุฎูู).
    
3. ุงุณุชูุดุงู ุงูุชุฑูููุงู:
    
    - ุฌุฑุจ ุชูููุฐ ุฃูุงูุฑ.
        
    - ุญุงูู ุนูู privilege escalation ููุดู ูุฃู ุงูุชุฑูููุงู ูููุฏ.
        
    - ูุตู ุงููุฏู ูุถูุญ ุฅู ุงูุชุฑูููุงู ูุชุงุญ ูุฃู ุญุฏ ููุฌุฑุฏ ุจูุฆุฉ ุชุฌุฑูุจูุฉ.
        
4. ูุญุงููุฉ ุชูููุฐ XSS:
    
    - ุฃูุดุฃ ููู `xss.html` ุจุฏุงุฎูู payload.
        
    - ูู ูุธูุฑ ุดูุก ุนูุฏ ุชุดุบููู.
        
5. **ุชุตูุญ ููุฏ ุงููุตุฏุฑ**:
    
    - ูุงุญุธ ูุณุงุฑ ูุซูุฑ:  
        `/usr/local/***/src/browser/media/favicon.ico`
        
    - ุฌุฑูุจ ุชุนุฏููู ุฅูู `/etc/passwd` ููุฌุญ ูู ุนุฑุถู โ
        

---

### ๐ฅ ุงูุชุฃุซูุฑ

- **LFI ูุคูุฏ**: ูููู ุนุฑุถ ูููุงุช ุญุณุงุณุฉ ูุซู `/etc/passwd`.
    
- ุญุงูู ุฑูุน WebShell (ุจุงูุชุฏุงุฏ .php) ููู ุงูุณูุฑูุฑ ูุฑุฌุน ุฏุงุฆููุง `Content-Type: text/plain` โก๏ธ ูุง ูููุนุด ุชูููุฐ ุฃููุงุฏ PHP.
    
- ุฑุฌุน ูุชุฌุฑุจุฉ ููู ุงูู XSS: ุฃุฎุฐ ุงูุฑุงุจุท ุงูุฏุงุฎูู ููููู ูููุฐู ูู `/etc/passwd`.
    
- ุงูู XSS ุงุดุชุบู ุฏุงุฎู ุตูุญุฉ `passwd` ุจุงุณุชุฎุฏุงู `alert(document.domain)` โ **Stored XSS ูุคูุฏ** โ
    

---

### โ Checklist

| ุฎุทูุฉ                            | ุชูุ               |
| ------------------------------- | ----------------- |
| ุงููุตูู ูู Terminal ููุชูุญุ       | โ                 |
| ุชูููุฐ ุฃูุงูุฑ ุฏุงุฎู ุงูู containerุ | โ                 |
| ูุฑุงุกุฉ ูููุงุช ุญุณุงุณุฉุ              | โ (`/etc/passwd`) |
| ุฑูุน ูููุงุชุ                      | โ                 |
| ุชูููุฐ ุฃููุงุฏุ                    | โ (PHP ูุด ุดุบุงู)   |
| XSS ุงุดุชุบูุ                      | โ                 |
| Stored XSSุ                     | โ                 |
# Bug Writeup Summary โ CSP Bypass โ MIME Sniffing โ Stored XSS

**๐ Link:**  
[https://infosecwriteups.com/content-security-policy-bypass-to-perform-xss-3c8dd0d40c2e](https://infosecwriteups.com/content-security-policy-bypass-to-perform-xss-3c8dd0d40c2e)

---

## ๐ฏ Target

- ูููุน ููู ุตูุญุชูู:
    
    - `index` ุจุชุนูุณ ูุฏุฎูุงุช ุงููุณุชุฎุฏู ุฏุงุฎู ุตูุญุฉ HTML
        
    - `countdown.php` ุจุชุนูุณ ูุฏุฎูุงุช ุฏุงุฎู ุณูุฑุจุช JavaScript
        

---

## ๐ง Vulnerability

- XSS ูุงูุช ููููุฉุ ููู CSP ูุงู ูุงูุน ุชูููุฐ ุงูุณูุฑุจุช
    
- ุจุงุณุชุฎุฏุงู ุซุบุฑุชูู XSS + MIME sniffingุ ุชู ุชูููุฐ JavaScript ูุชุฌุงูุฒ ุงูุญูุงูุฉ
    

---

## ๐ช Entry Point

- ุงูุฃูู: ุจุงุฑุงููุชุฑ ูู `index` ุจูุนูุณ HTML ุฒู `<script>` ููู ุจูุชู ููุนู ุจุณุจุจ CSP
    
- ุงูุซุงูู: ุจุงุฑุงููุชุฑ `end=` ูู `countdown.php` ุจูุนูุณ ุงููููุฉ ุฏุงุฎู ููุฏ JavaScriptุ ููููู ูุณุฑู ูุญูู ููุฏ ุฌุฏูุฏ
    

---

## โ๏ธ Payloads

### ๐งช PoC 1 โ HTML Injection:

ุฃุฏุฎููุง `<h1>kleiton0x00</h1>` ูุชุนุฑุถ ูุนูููุง ูุนูุตุฑ HTML ุฏุงุฎู ุงูุตูุญุฉ โ ูุนูู ุงูุงูุนูุงุณ ุดุบุงู

---

### ๐งช PoC 2 โ XSS ุจุณูุท (ููู ูุญุฌูุจ):

ุงุณุชุฎุฏููุง `<script>alert(1)</script>`ุ ูุชู ุญููู ูุนูุงู ููู ูู ููููุฐ ุจุณุจุจ CSP

---

### ๐งช PoC 3 โ ูุณุฑ ููุฏ JavaScript:

ุฃุฏุฎููุง `);alert(1);//` ุฏุงุฎู `countdown.php`ุ ูุฏู ูุณุฑ ุงูุณุทุฑ ุงูุจุฑูุฌู ูุณูุญ ุจุญูู ุณูุฑุจุช ุฌุฏูุฏ

ุงูุฑุงุจุท ูุงู:  
`http://website.com/js/countdown.php?end=2534926825);alert(1);//`  
ููู ุงูุชูููุฐ ูุดู ุจุณุจุจ ููุณ ุณูุงุณุฉ CSP

---

### ๐ต๏ธโโ๏ธ Final Exploit โ CSP Bypass via MIME Sniffing:

ุฏูุฌูุง ุงูุซุบุฑุชูู ูุน ุจุนุถ ุนู ุทุฑูู ุชุญููู ุณูุฑุจุช `countdown.php` ุฏุงุฎู `<script src=...>` ูู `index`:

`<script src='http://website.com/js/countdown.php?end=2534926825);alert(1);//'></script>`

ูุจูุง ุฅู ุงูุชุญููู ูู ููุณ ุงูุฏููููุ CSP ุณูุญ ุจุชุญููู ุงูุณูุฑุจุชุ ูุงููุชุตูุญ ููุฐู ุจุณุจุจ MIME sniffing

---

## ๐งฌ Exploitation Logic

- `countdown.php` ุจูุนูุณ ูุฏุฎู ุงููุณุชุฎุฏู ุฏุงุฎู ููุฏ JavaScript
    
- ุงูุณูุฑุจุช ุงุชุญูู ูู ููุณ ุงูุฏูููู ุจุงุณุชุฎุฏุงู `<script src=...>`
    
- ุงููุชุตูุญ ููุฐ ุงูุณูุฑุจุช ุจุงูุฑุบู ูู ุฅู ูุญุชูุงู ุฎุจูุซ
    
- CSP ุณูุญ ูุฃูู ูู ููุณ ุงููุตุฏุฑุ ูMIME sniffing ุฎูุงู ูุชููุฐ ูุนูููุง
    

---

## ๐ฅ Impact

- ุชูููุฐ ููุฏ JavaScript ุจุงูุฑุบู ูู ูุฌูุฏ ุณูุงุณุฉ CSP
    
- ูููู ุณุฑูุฉ Cookies ุฃู ุจูุงูุงุช ุญุณุงุณุฉ ุจุณูููุฉ
    
- ุงุณุชุบูุงู ุฏูุฌ ุซุบุฑุงุช ุจุณูุทุฉ ูุชุฌุงูุฒ ุญูุงูุฉ ูุชูุฏูุฉ
    

---

## ๐ Lessons Learned

- ูุด ูู XSS ูุญุชุงุฌุฉ ุชูููุฐ ูุจุงุดุฑุ ูููู ุชุณุชุบู ุซุบุฑุงุช ุชุงููุฉ ูุนุงูุง
    
- ุณูุฑุจุช ุฏุงุฎูู ุจูุนูุณ ูุฏุฎูุงุช = ูุฑุดุญ ููุงุณุชุบูุงู
    
- CSP ูุด ุฏุงูููุง ูุนุงูุฉ ูู MIME sniffing ุดุบุงู
    
- ุฏูุฌ XSS ูู HTML + JS ุจูุฎูู ุณููุงุฑูููุงุช ุงุณุชุบูุงู ูููุฉ
    

---

## ๐ Where to Retest

- ุตูุญุงุช HTML ุจุชุนูุณ ูุฏุฎูุงุช ุฌูู HTML
    
- ุณูุฑุจุชุงุช `.php` ุฃู `.js` ุจุชุนูุณ ูุฏุฎูุงุช ุฌูู JavaScript
    
- ููุงูุน ุจุชุณุชุฎุฏู CSP ูุจุชุณูุญ ุจุชุญููู ุณูุฑุจุชุงุช ูู ููุณ ุงูุฏูููู
    

---

## 


## Checklist (CSP Bypass via MIME Sniffing)

- ( ) ูู ููุฌุฏ ุงูุนูุงุณ HTML ูุจุงุดุฑุ ูุซู: `<h1>test</h1>`
    
- ( ) ูู ููุฌุฏ ุณูุฑุจุช ุฏุงุฎูู ูุนูุณ ูุฏุฎูุงุช ุฏุงุฎู JavaScriptุ
    
- ( ) ูู ูููู ูุณุฑ ููุฏ JavaScript ุจุญูู ูุซู: `);alert(1);//`ุ
    
- ( ) ูู ูููู ุชุญููู ุงูุณูุฑุจุช ูู ุฎูุงู `<script src=...>`ุ
    
- ( ) ูู ุณูุงุณุฉ CSP ุชุณูุญ ุจุชุญููู ุงูุณูุฑุจุช ูุฃูู ูู ููุณ ุงูุฏููููุ
    
- ( ) ูู ุงููุชุตูุญ ูุณุชุฎุฏู MIME sniffing ููููู ููุน ุงููุญุชููุ
    
- ( ) ูู ุชู ุชูููุฐ ุงูููุฏ ูุนูููุง ุฑุบู ูุฌูุฏ CSPุ
    

---# Bug Writeup Summary โ Web Cache Poisoning โ Reflected XSS โ Account Takeover

**๐ Link:**  
[https://lutfumertceylan.com.tr/posts/acc-takeover-web-cache-xss/](https://lutfumertceylan.com.tr/posts/acc-takeover-web-cache-xss/)

---

## ๐ฏ Target

- ูููุน ุดุฑูุฉ ุฃูุนุงุจ ููุฏูู ููู ุจุงุฑุงููุชุฑ `language` ุธุงูุฑ ูู ูู ุตูุญุงุช ุงููููุน
    
- ุงูุจุงุฑุงููุชุฑ ุฏู ุจูุนูุณ ุงููููุฉ ูุจุงุดุฑุฉ ูู ุงูู HTMLุ ุจุฏูู ุฃู ููุงุชุฑ
    

---

## ๐ง Vulnerability

- Reflected XSS ูู `language` parameter
    
- ุงูููู ุงููู ุจูุฏุฎููุง ุงููุณุชุฎุฏู ุจุชุชุญูุธ ูู **ุงูู Web Cache** โ ุชุตุนูุฏ ููุซุบุฑุฉ
    

---

## ๐ช Entry Point

- ุนูุฏ ูุชุญ ุงูุฑุงุจุท ูุน ุงููููุฉ ุงููุตุงุจุฉุ ุงููููุฉ ุจุชูุนูุณ ุฏุงุฎู ุงูุตูุญุฉ
    
- ุงูุณูุฑูุฑ ุจููุงุด ุงูุจุงุฑุงููุชุฑ ุงูุถุนูู `language` ุฌุฒุฆููุง (ูุด ุงูุตูุญุฉ ูููุง)
    

---

## โ๏ธ Payloads

### ๐งช PoC โ Reflected XSS:

ุฃุฏุฎููุง `1</script><svg/onload=confirm("document.cookie")>` ูู ุจุงุฑุงููุชุฑ `language`  
โ ุชู ุชูููุฐ XSS ุจูุฌุงุญ ูุณุฑูุฉ ุงูู session

---

### ๐ต๏ธโโ๏ธ Exploitation via Web Cache Poisoning:

ุจุณุจุจ ุฅู ุงูุณูุฑูุฑ ุจููุงุด ุงููููุฉ ุงููุตุงุจุฉุ ููุณ ุงูุจุงูููุฏ ุจูู ุจูุชุนุฑุถ ูู ุตูุญุงุช ุชุงููุฉ ุจุดูู ุชููุงุฆู

๐ ูุซุงู ุนูู ุงูุณููุงุฑูู:

- ุงูููุงุฌู ุจูุฒูุฑ ุงูุฑุงุจุท ููุญูู ุงูุจุงูููุฏ
    
- ุงููููุน ุจููุงุด ุงููููุฉ ุฏุงุฎู ุงูุตูุญุฉ
    
- ุฃู ุถุญูุฉ ุชุฒูุฑ ููุณ ุงูุตูุญุฉ ุจุนุฏ ูุฏู ุจุชุดูู ุงูุจุงูููุฏ ุจูุชููุฐ ุชููุงุฆููุง
    

---

## ๐งฌ Exploitation Logic

- Reflected XSS ุฏุงุฎู `language` parameter
    
- ุงููููุฉ ุจุชุชุฎุฒู ูู ุงููุงุด โ **Web Cache Poisoning**
    
- ุงูุถุญูุฉ ููุง ุชุฒูุฑ ุฃู ุตูุญุฉ ูููุง ุงูุจุงุฑุงููุชุฑุ ุจูุชู ุชูููุฐ ุงูููุฏ ุชููุงุฆู
    
- ูููุด `HttpOnly` ุฃู `Secure` ุฃู `CSP` ุชููุน ุณุฑูุฉ ุงูู cookies
    

---

## ๐ฅ Impact

- ุณุฑูุฉ ุงูุฌูุณุฉ (Session Hijacking)
    
- ุฅููุงููุฉ ุชูููุฐ **Account Takeover** ููู ูุณุชุฎุฏู ูุฒูุฑ ุงููููุน ุจุนุฏ ุงูุชูููุซ
    
- ุงูุชุดุงุฑ ุงูุซุบุฑุฉ ุนุจุฑ ุงููุงุด = ุนุฏุฏ ุถุญุงูุง ุฃูุจุฑ ุจุฏูู ุชุฏุฎู ูุจุงุดุฑ
    

---

## ๐ Lessons Learned

- Web Cache Poisoning ูููู ูุญููู XSS ุจุณูุทุฉ ูุซุบุฑุฉ ุดุฏูุฏุฉ ุงูุฎุทูุฑุฉ
    
- ุบูุงุจ `HttpOnly`, `Secure`, ู `CSP` ุจูุฎููู ุงูุซุบุฑุงุช ุฃุณูู ูู ุงูุงุณุชุบูุงู
    
- ูุงุฒู ุชุชุฃูุฏ ุฅู ุงูุจุงุฑุงููุชุฑุงุช ูุด ุจุชูุนูุณ ูุจุงุดุฑุฉ ุจุฏูู ููุงุชุฑ
    
- ุงูู caching ุงูุฌุฒุฆู ุฃุฎุทุฑ ูู ุงููุงูู ูู ุญุตู ูู ููุงุทู ูููุง ูุฏุฎูุงุช ูุณุชุฎุฏู
    

---

## ๐ Where to Retest

- ุฃู ุจุงุฑุงููุชุฑ ุจูุธูุฑ ูู ูู ุงูุตูุญุงุช (ุฒู language, theme, preview)
    
- ุณูุฑูุฑุงุช ุจุชุณุชุฎุฏู Web Cache ุฏุงุฎูู ุฃู CDN ุจุฏูู ููุชุฑุฉ ุนูู ุงูููู
    
- ููุงูุน ุจุชุฎุฒู ุฃุฌุฒุงุก ูู ุงูุฑุฏ ูู ุงููุงุด ุจุฏูู ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุญุชูู
    

---

## โ Checklist (Web Cache Poisoning โ XSS โ ATO)

- ( ) ูู ููู ุจุงุฑุงููุชุฑ ููุนูุณ ูู ุตูุญุฉ HTMLุ
    
- ( ) ูู ุงููููุฉ ุงููุตุงุจุฉ ูููู ุชุฎุฒู ูู ุงููุงุดุ
    
- ( ) ูู ุชู ุชูููุฐ XSS ุจุงุณุชุฎุฏุงู payload ุจุณูุท ุฒู: `</script><svg/onload=alert(1)>`ุ
    
- ( ) ูู ุงููููุน ุจูุณุชุฎุฏู ูุงุด ุฏุงุฎูู ุฃู CDNุ
    
- ( ) ูู ูู ุบูุงุจ ุชุงู ูู `HttpOnly`, `Secure`, ุฃู `CSP`ุ
    
- ( ) ูู ูููู ุงููุตูู ูููุณ ุงูุตูุญุฉ ูู ุงูุถุญูุฉ ุจุนุฏ ุงูุชูููุซุ
    
- ( ) ูู ุญุตู ุชูููุฐ ุชููุงุฆู ููุจุงูููุฏ ุจุนุฏ ุงููุงุดุ
    

---